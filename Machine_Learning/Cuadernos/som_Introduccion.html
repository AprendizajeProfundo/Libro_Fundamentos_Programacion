
<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Mapas Auto-organizados (SOM) &#8212; Fundamentos de IA y AP</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../../_static/tabs.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="Introducción a Redes Neuronales" href="../../Redes_Neuronales/Cuadernos/RedesNeuronales_intro.html" />
    <link rel="prev" title="Análisis de correspondencias múltiples (ACM)" href="ACM.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="es">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo-final-ap.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Fundamentos de IA y AP</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../tutorial.html">
                    <span style="color:#F72585">Bienvenido(a)</span>
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Conociendo el libro
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Inicio/Cuadernos/Consideraciones.html">
   <span style="color:#F72585">
    Conociendo el Libro
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fundamentos de Estadística
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Prob_Conceptos_Basicos.html">
   <span style="color:#F72585">
    Probabilidad
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Prob_Variables_Aleatorias.html">
   <span style="color:#F72585">
    Variables Aleatorias
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Prob_Var_Prob_conjunta.html">
   <span style="color:#F72585">
    Probabilidad Conjunta y Entropía Cruzada
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Prob_Distribuciones_continuas.html">
   <span style="color:#F72585">
    Distribuciones de probabilidad continuas
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/Regresi%C3%B3n-Lineal-Pyton-Copy1.html">
   <span style="color:#F72585">
    Regresión Lineal en Python
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Teoría de la Información
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Estadistica/Cuadernos/ti_Teoria_Informacion.html">
   <span style="color:#F72585">
    Teoría de la Información
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Álgebra Lineal
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Intro_Tensores_I.html">
   <span style="color:#F72585">
    Introducción a tensores
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Intro_Tensores_II.html">
   <span style="color:#F72585">
    Tensores
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Tensor_Distribucion_Prob.html">
   <span style="color:#F72585">
    Tensores y distribuciones de probabilidad
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Modelación
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/mod_Modelamiento.html">
   <span style="color:#F72585">
    Ejemplos de Modelos
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/mod_Ejemplo_Modelamiento.html">
   <span style="color:#F72585">
    Ejemplos de Modelamiento
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/cal_derivadas.html">
   <span style="color:#F72585">
    Introducción a la Derivación
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Optimization_1.html">
   <span style="color:#F72585">
    Optimización univariada usando JAX
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/Optimization_2.html">
   <span style="color:#F72585">
    Optimización multivariada usando JAX
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Fundamentacion_Matematica/Cuadernos/am-sdg.html">
   <span style="color:#F72585">
    Optimización
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Aprendizaje de máquinas
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="am_intro_aprendizaje_maquinas.html">
   <span style="color:#F72585">
    Conceptos básicos de aprendizaje de máquinas
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="am_Regresion_logistica_JAX.html">
   <span style="color:#F72585">
    Modelo Lineal de Clasificación  con JAX
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="am_Regresion_Logistica_Tensorflow.html">
   <span style="color:#F72585">
    Modelo Logístico de Clasificación  con Tensorflow 2.X
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="am_regresion_Keras.html">
   <span style="color:#F72585">
    Regresion Basica con tf.keras: Predecir eficiencia de la gasolina
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="am-logistico-keras-cancer.html">
   <span style="color:#F72585">
    Modelo logístico de predicción en tf.keras
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Aprendizaje de máquinas no supervisado
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="BreveIntroduccion2R.html">
   <span style="color:#F72585">
    Breve introducción a R
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="AprendizajeNoSupervisado.html">
   <span style="color:#F72585">
    Aprendizaje no supervisado
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ACP.html">
   <span style="color:#F72585">
    Análisis en componentes principales
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ACS.html">
   <span style="color:#F72585">
    Análisis de correspondencias simples
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ACM.html">
   <span style="color:#F72585">
    Análisis de correspondencias múltiples (ACM)
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Mapas auto-organizados (SOM)
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   <span style="color:#F72585">
    Mapas Auto-organizados (SOM)
   </span>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Redes Neuronales
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/RedesNeuronales_intro.html">
   <span style="color:#F72585">
    Introducción a Redes Neuronales
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/Activation_Functions.html">
   <span style="color:#F72585">
    Funciones de Activación
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/Hello_World_ML.html">
   <span style="color:#F72585">
    Introducción a Keras Sequential y API Funcional
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/Intro_Keras_Sequential.html">
   <span style="color:#F72585">
    Introducción a la API Sequential de Keras
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/Intro_Keras_Functional.html">
   <span style="color:#F72585">
    Introducción a la API funcional de Keras
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/am-softmax-keras-iris.html">
   <span style="color:#F72585">
    Clasificación, Softmax, Iris
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/am_regresion_Keras_gasolina.html">
   <span style="color:#F72585">
    Regresion Basica con tf.keras: Predecir eficiencia de la gasolina
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/am-subclassing-iris.html">
   <span style="color:#F72585">
    Subclassing-Modelo de Regresión multi-logística
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Redes_Neuronales/Cuadernos/NN_Animation2.html">
   <span style="color:#F72585">
    Visualización del Entrenamiento de una Red Neuronal
   </span>
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/AprendizajeProfundo/Libro-Fundamentos/main?urlpath=tree/Machine_Learning/Cuadernos/som_Introduccion.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/AprendizajeProfundo/Libro-Fundamentos/blob/main/Machine_Learning/Cuadernos/som_Introduccion.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/AprendizajeProfundo/Libro-Fundamentos"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/AprendizajeProfundo/Libro-Fundamentos/issues/new?title=Issue%20on%20page%20%2FMachine_Learning/Cuadernos/som_Introduccion.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/AprendizajeProfundo/Libro-Fundamentos/edit/main/Machine_Learning/Cuadernos/som_Introduccion.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/Machine_Learning/Cuadernos/som_Introduccion.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-instalar-minisom-span">
   <span style="color:#4361EE">
    Instalar Minisom
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-introduccion-span">
   <span style="color:#4361EE">
    Introducción
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-mapas-cerebrales-span">
   <span style="color:#4361EE">
    Mapas cerebrales
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-aprendizaje-competitivo-span">
   <span style="color:#4361EE">
    Aprendizaje competitivo
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-cuantizacion-vectorial-span">
   <span style="color:#4361EE">
    Cuantización vectorial
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-aprendizaje-de-cuantizacion-vectorial-span">
   <span style="color:#4361EE">
    Aprendizaje de cuantización vectorial
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-algoritmo-k-means-span">
   <span style="color:#4361EE">
    Algoritmo K-means
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-el-algoritmo-span">
     <span style="color:#4CC9F0">
      El algoritmo
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-teselacion-de-voronoi-span">
   <span style="color:#4361EE">
    Teselación de Voronoi
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-conjunto-de-voronoi-span">
     <span style="color:#4CC9F0">
      Conjunto de Voronoi
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-mapas-auto-organizados-de-kohonen-som-span">
   <span style="color:#4361EE">
    Mapas Auto-Organizados de Kohonen (SOM)
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-funcion-de-vecindad-span">
     <span style="color:#4CC9F0">
      Función de vecindad
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-rata-de-aprendizaje-span">
     <span style="color:#4CC9F0">
      Rata de aprendizaje
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-pesos-sinapticos-span">
     <span style="color:#4CC9F0">
      Pesos sinápticos
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-asignacion-de-los-datos-a-las-neuronas-en-el-som-span">
     <span style="color:#4CC9F0">
      Asignación de los datos a las neuronas en el SOM
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-el-algortimo-de-entrenamiento-som-span">
   <span style="color:#4361EE">
    El algortimo de entrenamiento SOM
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-ejemplos-con-minisom-span">
   <span style="color:#4361EE">
    Ejemplos con Minisom
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-datos-simulados-span">
     <span style="color:#4CC9F0">
      Datos simulados
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-un-primer-ejemplo-historico-grafico-de-la-pobreza-span">
     <span style="color:#4CC9F0">
      Un primer ejemplo histórico. Gráfico de la pobreza
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-codigos-con-minisom-span">
     <span style="color:#4CC9F0">
      Códigos con Minisom
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-digitos-a-mano-alzada-span">
     <span style="color:#4CC9F0">
      Dígitos a mano alzada
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-indice-de-democracia-span">
     <span style="color:#4CC9F0">
      índice de democracia
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#map-of-countries">
   Map of countries
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-planos-de-catacteristicas-span">
     <span style="color:#4CC9F0">
      Planos de Catacterísticas
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-plano-de-caracteristicas-mas-importantes-span">
     <span style="color:#4CC9F0">
      Plano de características más importantes
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-referencias-span">
   <span style="color:#4361EE">
    Referencias
   </span>
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1><span style="color:#F72585">Mapas Auto-organizados (SOM)</span></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-instalar-minisom-span">
   <span style="color:#4361EE">
    Instalar Minisom
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-introduccion-span">
   <span style="color:#4361EE">
    Introducción
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-mapas-cerebrales-span">
   <span style="color:#4361EE">
    Mapas cerebrales
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-aprendizaje-competitivo-span">
   <span style="color:#4361EE">
    Aprendizaje competitivo
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-cuantizacion-vectorial-span">
   <span style="color:#4361EE">
    Cuantización vectorial
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-aprendizaje-de-cuantizacion-vectorial-span">
   <span style="color:#4361EE">
    Aprendizaje de cuantización vectorial
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-algoritmo-k-means-span">
   <span style="color:#4361EE">
    Algoritmo K-means
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-el-algoritmo-span">
     <span style="color:#4CC9F0">
      El algoritmo
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-teselacion-de-voronoi-span">
   <span style="color:#4361EE">
    Teselación de Voronoi
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-conjunto-de-voronoi-span">
     <span style="color:#4CC9F0">
      Conjunto de Voronoi
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-mapas-auto-organizados-de-kohonen-som-span">
   <span style="color:#4361EE">
    Mapas Auto-Organizados de Kohonen (SOM)
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-funcion-de-vecindad-span">
     <span style="color:#4CC9F0">
      Función de vecindad
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-rata-de-aprendizaje-span">
     <span style="color:#4CC9F0">
      Rata de aprendizaje
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-pesos-sinapticos-span">
     <span style="color:#4CC9F0">
      Pesos sinápticos
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-asignacion-de-los-datos-a-las-neuronas-en-el-som-span">
     <span style="color:#4CC9F0">
      Asignación de los datos a las neuronas en el SOM
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-el-algortimo-de-entrenamiento-som-span">
   <span style="color:#4361EE">
    El algortimo de entrenamiento SOM
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-ejemplos-con-minisom-span">
   <span style="color:#4361EE">
    Ejemplos con Minisom
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-datos-simulados-span">
     <span style="color:#4CC9F0">
      Datos simulados
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-un-primer-ejemplo-historico-grafico-de-la-pobreza-span">
     <span style="color:#4CC9F0">
      Un primer ejemplo histórico. Gráfico de la pobreza
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-codigos-con-minisom-span">
     <span style="color:#4CC9F0">
      Códigos con Minisom
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-digitos-a-mano-alzada-span">
     <span style="color:#4CC9F0">
      Dígitos a mano alzada
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-indice-de-democracia-span">
     <span style="color:#4CC9F0">
      índice de democracia
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#map-of-countries">
   Map of countries
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-planos-de-catacteristicas-span">
     <span style="color:#4CC9F0">
      Planos de Catacterísticas
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-4cc9f0-plano-de-caracteristicas-mas-importantes-span">
     <span style="color:#4CC9F0">
      Plano de características más importantes
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-4361ee-referencias-span">
   <span style="color:#4361EE">
    Referencias
   </span>
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="span-style-color-f72585-mapas-auto-organizados-som-span">
<h1><span style="color:#F72585">Mapas Auto-organizados (SOM)</span><a class="headerlink" href="#span-style-color-f72585-mapas-auto-organizados-som-span" title="Enlazar permanentemente con este título">#</a></h1>
<section id="span-style-color-4361ee-instalar-minisom-span">
<h2><span style="color:#4361EE">Instalar Minisom</span><a class="headerlink" href="#span-style-color-4361ee-instalar-minisom-span" title="Enlazar permanentemente con este título">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!pip install minisom</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="span-style-color-4361ee-introduccion-span">
<h2><span style="color:#4361EE">Introducción</span><a class="headerlink" href="#span-style-color-4361ee-introduccion-span" title="Enlazar permanentemente con este título">#</a></h2>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Machine_Learning/Imagenes/Teuvo-Kohonen.jpg" width="150" height="120" align="right"/>
</center>
<figcaption>
</figcaption>
</figure>
<p>El profesor Kohonen ha hecho importantes investigaciones y contribuciones en el campo de las redes neuronales artificiales incluyendo el algoritmo LVQ y su más famosa contribución: los mapas auto organizados (también conocidas como redes de Kohonen o SOMs), así como también a las teorías fundamentales de la memoria asociativa distribuida y mapas asociativos óptimos, entre otros. La mayor parte de sus investigaciones las ha llevado a cabo en la que actualmente es la Universidad Aalto y ha recibido varios premios en reconocimiento a sus logros científicos</p>
<p>Teuvo Kohenen. Fuente: <a class="reference external" href="https://es.wikipedia.org/wiki/Teuvo_Kohonen">Wikipedia</a></p>
</section>
<section id="span-style-color-4361ee-mapas-cerebrales-span">
<h2><span style="color:#4361EE">Mapas cerebrales</span><a class="headerlink" href="#span-style-color-4361ee-mapas-cerebrales-span" title="Enlazar permanentemente con este título">#</a></h2>
<p>Areas del cerebro. Fuente: <a class="reference external" href="http://library.lol/main/FC8ACDF0F2C224BE45E2BE6BB0D39F4E">Self-Organizing-Maps</a></p>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Machine_Learning/Imagenes/Brain_areas.png" width="400" height="300" align="left"/>
</center>
</figure>
<p>Las diversas áreas del cerebro, especialmente de la corteza cerebral, están organizadas de acuerdo con diferentes modalidades sensoriales:</p>
<ol class="simple">
<li><p>Tareas especializadas: control del habla.</p></li>
<li><p>Señales sensoriales (visuales, auditivas, somatosensoriales).</p></li>
<li><p>…</p></li>
</ol>
<p>Entre las áreas sensoriales primarias (10% del área cortical) hay áreas asociativas, en las que convergen señales de diferentes modalidades.</p>
<p><span class="math notranslate nohighlight">\(\leadsto\)</span> Es posible distinguir <strong>tres tipos de mapas</strong>:</p>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Machine_Learning/Imagenes/somatotopic_map.png" width="300" height="200" align="right"/>
</center>
</figure>
<ol class="simple">
<li><p>Mapas de habilidades característica específicas, cuya ubicación espacial no se correlaciona con ningún valor de característica.</p></li>
<li><p>Proyección anatómica sobre alguna superficie receptora . Por ejemplo: cortezas somáticas visuales.</p></li>
<li><p>Mapas ordenados de alguna característica abstracta, para la cual no existe una superficie de repetición. Por ejemplo, el color en el área visual.</p></li>
</ol>
<p>Mapa somatotópico. Fuente:  <a class="reference external" href="http://library.lol/main/FC8ACDF0F2C224BE45E2BE6BB0D39F4E">Self-Organizing-Maps</a></p>
<p><span class="math notranslate nohighlight">\(\leadsto\)</span> Las principales estructuras de las redes cerebrales están determinadas genéticamente. Sin embargo, las proyecciones sensoriales se ven afectadas por la experiencia. Por ejemplo, después de la ablación de órganos sensoriales o tejidos cerebrales o la privación sensorial a una edad temprana, algunas proyecciones no se desarrollan.</p>
</section>
<section id="span-style-color-4361ee-aprendizaje-competitivo-span">
<h2><span style="color:#4361EE">Aprendizaje competitivo</span><a class="headerlink" href="#span-style-color-4361ee-aprendizaje-competitivo-span" title="Enlazar permanentemente con este título">#</a></h2>
<p>Un orden topográfico o anatómico puro de las conexiones neuronales podría explicarse fácilmente como sigue.</p>
<p><em>Los axones de las células neurales, cuando crecen hacia sus destinos, pueden ser mantenidos separados por las estructuras celulares, y el destino se encuentra siguiendo la acción de los marcadores químicos</em>.</p>
<p>Mapa tonotópico. Fuente:  <a class="reference external" href="http://library.lol/main/FC8ACDF0F2C224BE45E2BE6BB0D39F4E">Self-Organizing-Maps</a></p>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Machine_Learning/Imagenes/tonotopic_map.png" width="300" height="200" align="left"/>
</center>
</figure> 
<p>Sin embargo, existe algo de confusión, porque estas conexiones no siempre son una a una, debido a que también existen las estaciones de procesamiento de las rutas de transmisión de señal (núcleos) en las que se mezclan las señales. Por ejemplo, en la corteza auditiva existe el mapa tonotópico de frecuencia acústica de tonos percibidos.</p>
<p><span class="math notranslate nohighlight">\(\leadsto\)</span> Para concluir: en el cerebro existe un <strong>orden espacial y una organización</strong> significativa de las funciones cerebrales.</p>
<p>Estos hechos clave fueron los cimientos que Kohonen utilizó para imaginar sus mapas autoorganizados.</p>
<p>A continuación se introducen los conceptos clave usado en la construcción de un SOM.</p>
</section>
<section id="span-style-color-4361ee-cuantizacion-vectorial-span">
<h2><span style="color:#4361EE">Cuantización vectorial</span><a class="headerlink" href="#span-style-color-4361ee-cuantizacion-vectorial-span" title="Enlazar permanentemente con este título">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Vector</span> <span class="pre">Quantization</span></code> (Cuantificación Vectorial) es una técnica por la cual el espacio de entradas es dividido en un número determinado de regiones y para cada una de ellas es definido un vector que la caracteriza. Un espacio continuo tiene que ser discretizado. La entrada al sistema son vectores n-dimensionales y la salida es una representación discreta del espacio de entradas. El método Vector Quantization (LVQ) fue originalmente desarrollado por Linde (1980) y Gray (1984). Y como una herramienta para compresión de datos por Gersho y Gray,1992.</p>
<p>Es una técnica usada para reducir la dimensionalidad de datos. Los datos originales constituyen un conjunto de vectores de dimensión <span class="math notranslate nohighlight">\(n\)</span>. Estos vectores son mapeados en un conjunto más pequeño de valores llamado <code class="docutils literal notranslate"><span class="pre">codebook</span></code> o libro de códigos. Tales valores son usados para almacenamiento o transmisión de información, con  alguna pérdida.</p>
<p>En el proceso de entrenamiento, los valores del codebook son re-trasladados a valores de codebook que representan a vectores que son cercanos en los datos originales.</p>
</section>
<section id="span-style-color-4361ee-aprendizaje-de-cuantizacion-vectorial-span">
<h2><span style="color:#4361EE">Aprendizaje de cuantización vectorial</span><a class="headerlink" href="#span-style-color-4361ee-aprendizaje-de-cuantizacion-vectorial-span" title="Enlazar permanentemente con este título">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Learning</span> <span class="pre">Vector</span> <span class="pre">Quantization</span></code> (LVQ) es un método para el entrenamiento competitivo de una manera supervisada. Una capa competitiva automáticamente aprenderá a clasificar automáticamente vectores de entrada. Sin embargo, las clases que la capa competitiva encuentra dependen únicamente de los vectores de entrada. Si dos vectores de entrada son muy similares, la capa competitiva probablemente los colocara en la misma clase. No existe mecanismo en el diseño de una capa competitiva para dictaminar si cualquiera de los vectores de entrada están la misma clase o no. Las redes LVQ aprenden a clasificar vectores de entrada en clases seleccionadas por el usuario. Kohonen, diseñó versiones supervisadas de este método, para problemas de clasificación adaptativa de patrones.</p>
<p>Matemáticamente, LVQ es un método de aproximación de señales en el cual se busca  elaborar una aproximación cuantizada de la distribución de los vectores de entrada. <span class="math notranslate nohighlight">\(x \in \mathfrak {R}^n \)</span>, usando un conjunto finito de  códigos  llamado <em>codebook</em>. Denotemos a los elementos del codebook como  <span class="math notranslate nohighlight">\(m_i \in \mathfrak {R} ^n, \quad i = 1,2, \ldots, k \)</span> .</p>
<p>Supongamos que ya he ha eligido  el <em>codebook</em>. Aproximar el vector  <span class="math notranslate nohighlight">\(x\)</span> significa encontrar el vector <span class="math notranslate nohighlight">\(m_c\)</span>  en el <em>codebook</em> más cercano a <span class="math notranslate nohighlight">\(x\)</span> (en el espacio de entrada), generalmente usando  la métrica euclidiana. Es decir, se busca encontrar <span class="math notranslate nohighlight">\(m_c\)</span> tal que</p>
<div class="math notranslate nohighlight">
\[
||x -m_c|| = \underset{i}{min} \{ ||x -m_i|| \}, \text{ o equivalentemente }
\]</div>
<div class="math notranslate nohighlight">
\[
c =  \underset{i}{arg min} \{ ||x -m_i|| \}.
\]</div>
<p><span class="math notranslate nohighlight">\(\leadsto\)</span> Realmente, no es necesario utilizar la métrica euclidiana. Si existe una matriz de índices de similitud para medir la similitud entre los elementos de la muestra, el algoritmo puede usar esta medida de similitud para calcular la aproximación.</p>
</section>
<section id="span-style-color-4361ee-algoritmo-k-means-span">
<h2><span style="color:#4361EE">Algoritmo K-means</span><a class="headerlink" href="#span-style-color-4361ee-algoritmo-k-means-span" title="Enlazar permanentemente con este título">#</a></h2>
<p>Un algoritmo general que se puede utilizar para calcular un <em>codebook</em> a partir de una muestra es el algoritmo <strong>k-means</strong>. Este es un algoritmo de tipo experanza-maximización (EM).</p>
<p>Supongamos que tenemos un conjunto de datos <span class="math notranslate nohighlight">\( X = \{x_1, \ldots, x_N; \quad x_i \in \mathfrak {R} ^ n \} \)</span>.</p>
<p>El objetivo es dividir el conjunto de datos en un número de clústeres de <span class="math notranslate nohighlight">\(K\)</span>, para un valor de <span class="math notranslate nohighlight">\( K \)</span> dado.</p>
<p>Denotemos por <span class="math notranslate nohighlight">\( m_k,  k = 1, \ldots, K \)</span> al vector de codebook asociado con el grupo <span class="math notranslate nohighlight">\( k \)</span>-th. Para cada punto  <span class="math notranslate nohighlight">\( x_n \)</span> introducimos un vector de variables binarias <span class="math notranslate nohighlight">\( r_{nk} \in \{0,1 \} \)</span>, donde <span class="math notranslate nohighlight">\( k = 1, \ldots, K \)</span>, la indica a cuál de los <span class="math notranslate nohighlight">\( K \)</span> clústeres  está asignado el punto <span class="math notranslate nohighlight">\( x_n \)</span>.</p>
<p>La función objetivo (pérdida) se define como</p>
<div class="math notranslate nohighlight">
\[
J = \sum_{n=1}^{N}\sum_{k=1}^{K} r_{nk}||x_n-m_k||^2.
\]</div>
<p>Intuitivamente, esperamos que cada grupo contenga un conjunto de puntos  cuyas distancias entre puntos sean pequeñas en comparación con las distancias a puntos fuera del grupo.</p>
<section id="span-style-color-4cc9f0-el-algoritmo-span">
<h3><span style="color:#4CC9F0">El algoritmo</span><a class="headerlink" href="#span-style-color-4cc9f0-el-algoritmo-span" title="Enlazar permanentemente con este título">#</a></h3>
<ol class="simple">
<li><p>Escoger aleatoriamente algunos valores <span class="math notranslate nohighlight">\(m_k\)</span>.</p></li>
<li><p><strong>Paso E</strong>. Para cada  <span class="math notranslate nohighlight">\(x_n\)</span> sea <span class="math notranslate nohighlight">\(r_{nk}=1\)</span>, tal que <span class="math notranslate nohighlight">\(k =  \underset{i}{arg min} \{ ||x -m_i||\)</span>, and <span class="math notranslate nohighlight">\(r_{nl}=0\)</span> para <span class="math notranslate nohighlight">\(l\ne k\)</span>.</p></li>
<li><p><strong>Paso M</strong>. La función objetivo <span class="math notranslate nohighlight">\(J\)</span> es cuadrática, así que solamente tiene un mínimo. El extremo se puede calcular directamente minimizando <span class="math notranslate nohighlight">\(J\)</span> para obtener</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
m_k = \frac{\sum_n r_{nk}x_n}{\sum_n r_{nk}}.
\]</div>
<p>Los pasos 2 y 3 se repiten hasta convergencia.</p>
</section>
</section>
<section id="span-style-color-4361ee-teselacion-de-voronoi-span">
<h2><span style="color:#4361EE">Teselación de Voronoi</span><a class="headerlink" href="#span-style-color-4361ee-teselacion-de-voronoi-span" title="Enlazar permanentemente con este título">#</a></h2>
<p>La siguiente figura ejemplifica un espacio bidimensional donde un número finito de libro de códigos o <code class="docutils literal notranslate"><span class="pre">vectores</span> <span class="pre">de</span> <span class="pre">referencia</span></code> se muestra como puntos, correspondientes a sus coordenadas. Este espacio está dividido en regiones, delimitado por líneas (en general hiperplanos) de modo que cada partición contiene un vector de referencia que es el <code class="docutils literal notranslate"><span class="pre">vecino</span> <span class="pre">más</span> <span class="pre">cercano</span></code> en promedio a cualquier vector dentro de la misma partición. Estas líneas constituyen la teselación de Voronoi.</p>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Machine_Learning/Imagenes/Voronoi_tessellation.png" width="400" height="400" align="center"/>
</center>
<figcaption>
<p style="text-align:center">Teselación de Voronoi</p>
</figcaption>
</figure>
<p>Fuente:  <a class="reference external" href="http://library.lol/main/FC8ACDF0F2C224BE45E2BE6BB0D39F4E">Self-Organizing-Maps</a></p>
<section id="span-style-color-4cc9f0-conjunto-de-voronoi-span">
<h3><span style="color:#4CC9F0">Conjunto de Voronoi</span><a class="headerlink" href="#span-style-color-4cc9f0-conjunto-de-voronoi-span" title="Enlazar permanentemente con este título">#</a></h3>
<p>Se dice que todos los vectores <span class="math notranslate nohighlight">\( x \)</span> que tienen un vector de referencia particular como su vecino más cercano en la partición correspondiente de la teselación de Voronoi constituyen el conjunto de Voronoi.</p>
<p>El propósito con los mapas auto-organizados (SOM) es construir una especie de teselación de la nube de puntos de entrada.</p>
</section>
</section>
<section id="span-style-color-4361ee-mapas-auto-organizados-de-kohonen-som-span">
<h2><span style="color:#4361EE">Mapas Auto-Organizados de Kohonen (SOM)</span><a class="headerlink" href="#span-style-color-4361ee-mapas-auto-organizados-de-kohonen-som-span" title="Enlazar permanentemente con este título">#</a></h2>
<p>Los mapas auto organizados (SOM), también conocidos como mapas de Kohonen, son un tipo de redes neuronales artificiales capaces de convertir relaciones estadísticas complejas y no lineales entre elementos de datos de alta dimensión en relaciones geométricas simples en una grilla de baja dimensión.</p>
<p>En un SOM, las neuronas están organizadas en una grilla, por lo general bidimensional, aunque puede ser de mayor dimensión,  y cada neurona está completamente conectada a todos los nodos de origen en la capa de entrada. Una ilustración <a class="reference external" href="https://arxiv.org/pdf/1312.5753.pdf">Matias Carrasco Kind y Robert J. Brunner</a>  es la siguiente</p>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Machine_Learning/Imagenes/som_structure.png" width="600" height="500" align="center"/>
</center>
<figcaption>
<p style="text-align:center">  Estructura de construcción del mapa autoorganizado</p>
</figcaption>
</figure>
<p>Fuente: <a class="reference external" href="https://arxiv.org/pdf/1312.5753.pdf">Matias Carrasco Kind y Robert J. Brunner</a></p>
<p>La idea central de Kohonen fue preservar hasta donde fuera posible la estructura topológica de los datos. Es decir, es busca una representación de los datos en la grilla de las neuronas de tal manera que las distancias relativas de los puntos se preservan en la grilla.</p>
<p>Entonces se predefine la grilla de neuronas y el procedimiento busca asignar una celda de la grilla, es decir una neurona, a cada punto de entrada.</p>
<p>La siguiente imagen ilustra como un SOM trata de representar a un conjunto de puntos. En la derecha se dibujan los puntos en la grilla. Se observa una celda (neurona) puede representar a varios puntos. En otras palabras, la proyección no es 1:1, debido a que en general habrá muchos más puntos de datos que neuronas. También puede ocurrir que algunas neuronas no reciban datos proyectados en ella.</p>
<p>En la imagen las neuronas estan representadas en una grilla de celdas hexagonales. Son usuales también grillas rectangulares y otra representaciones. Para mantener la sencillez, vamos a trabajar con grillas de neuronas bidimensionales.</p>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Machine_Learning/Imagenes/latent_space_som.png" width="600" height="500" align="center"/>
</center>
<figcaption>
<p style="text-align:center">Estructura latente representada por el  mapa autoorganizado</p>
</figcaption>
</figure>
<p>Fuente: <a class="reference external" href="http://library.lol/main/FC8ACDF0F2C224BE45E2BE6BB0D39F4E">Self Organizing Maps</a></p>
<p>Vamos a suponer una configuración de <span class="math notranslate nohighlight">\(N= p\times q\)</span> en la grilla de salida. Cada neurona <span class="math notranslate nohighlight">\(i\)</span> tiene asociada una par de coordenadas enteras, digamos <span class="math notranslate nohighlight">\((i_1,i_2)\)</span> y estan organizadas de tal manera que por ejemplo la neurona más a la izquierda y arriba tiene coordenada (0,0) y la mas a la derecha abajo (p-1, q-1).</p>
<p>Estas coordenadas permiten definir el concepto de función vecindad de una neurona.</p>
<section id="span-style-color-4cc9f0-funcion-de-vecindad-span">
<h3><span style="color:#4CC9F0">Función de vecindad</span><a class="headerlink" href="#span-style-color-4cc9f0-funcion-de-vecindad-span" title="Enlazar permanentemente con este título">#</a></h3>
<p>Para una neurona, digamos <span class="math notranslate nohighlight">\(i, i=1,\cdots,N\)</span>, su función de vecindad define su cercanía con las demás neuronas, la cual es una función de la diferencia entre sus coordenadas.</p>
<p>La función de vecidad más comúnmente usada es el kernel Gaussiano. Por ejemplo para la neurona <span class="math notranslate nohighlight">\(i\)</span>, con coordenadas <span class="math notranslate nohighlight">\(n_i=(i_1,i_2)\)</span>, su función de vencidad se define por</p>
<div class="math notranslate nohighlight">
\[
h_{ij} = \exp \left( -\frac{|| n_i-n_j||^2}{2\sigma^2} \right)
\]</div>
<p>En el proceso de entrenamiento la función de vecindad cambia en cada paso <span class="math notranslate nohighlight">\(t\)</span>. Normalmente esa función de vecindad es cada vez mas restringida. Entonces el parámetro de dispersión <span class="math notranslate nohighlight">\(\sigma\)</span> depende del tiempo en el proceso de entrenamiento. Por esto, en general escribiremos que las función de vecindad depende del tiempo y se escribirá</p>
<div class="math notranslate nohighlight">
\[
h_{ij}(t) = \exp \left( -\frac{|| n_i-n_j||^2}{2\sigma^2(t)} \right),
\]</div>
<p>en donde se espera que <span class="math notranslate nohighlight">\(\sigma^2(t)\to 0\)</span> cuando <span class="math notranslate nohighlight">\(t\to \infty\)</span>. Así la <em>vecidad</em> de la neurona  se va encogiendo a medida que avanza el entrenamiento.</p>
<p>No olvide que el concepto de vecindad es de las neuronas y su cálculo se basa en la posición de las neuronas en la grilla predefinida para el entrenamiento.</p>
<p>Un ejemplo de cálculo es el siguiente. Supongamos que <span class="math notranslate nohighlight">\(n_i=(2,3)\)</span> y <span class="math notranslate nohighlight">\(n_j=(5,2)\)</span>. Además supongamos que <span class="math notranslate nohighlight">\(\sigma^2(t) = 0.2\)</span> para algun paso <span class="math notranslate nohighlight">\(t\)</span> en el entrenamiento. Entonces, se tiene que</p>
<div class="math notranslate nohighlight">
\[
h_{ii}(t) = 1, 
\]</div>
<p>debido a que el exponente es cero. Además,</p>
<div class="math notranslate nohighlight">
\[
h_{ij}(t) =  \exp \left( -\frac{|| n_i-n_j||^2}{2\sigma^2(t)} \right) = \exp \left( -\frac{(2-5)^2 + (3-2)^2}{2\times 0.2} \right) = 1.389\times 10^{-11}.
\]</div>
<p>La imagen ilustra el concepto de vecindad.</p>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Machine_Learning/Imagenes/som_neighborhood.png"" width="400" height="400" align="center"/>
</center>
<figcaption>
<p style="text-align:center">Vecindad en un SOM. Vecindarios (Nc) para una matriz rectangular de unidades de clúster: Nc = 0 entre rectángulos negros, Nc = 1 en rojo y Nc = 2 en azul.</p>
</figcaption>
</figure>
<p>Fuente:</p>
</section>
<section id="span-style-color-4cc9f0-rata-de-aprendizaje-span">
<h3><span style="color:#4CC9F0">Rata de aprendizaje</span><a class="headerlink" href="#span-style-color-4cc9f0-rata-de-aprendizaje-span" title="Enlazar permanentemente con este título">#</a></h3>
<p>Como es usual en los algoritmos de entrenamiento de redes neuronales se define una rata de aprendizaje que dosifica el tamaño (la norma)  del gradiente en el proceso de busqueda de un óptimo. Kohonen se basó inicialmente en la técnica del gradiente descendiente estocástico propuesta por <a class="reference external" href="https://projecteuclid.org/journals/annals-of-mathematical-statistics/volume-22/issue-3/A-Stochastic-Approximation-Method/10.1214/aoms/1177729586.full">Robbins-Monro</a> .</p>
<p>Ellos propusieron que el paso de cada muestra por el optimizador sea en forma aleatoria y la rata de entrenamiento definida de tal manera que si la rata en el paso <span class="math notranslate nohighlight">\(t\)</span> es <span class="math notranslate nohighlight">\(r(t)\)</span> entonces <span class="math notranslate nohighlight">\(\sum r(t)\to \infty \)</span> y <span class="math notranslate nohighlight">\(\sum r^2(t)&lt;\infty\)</span>. Por ejemplo es usual definir <span class="math notranslate nohighlight">\(r(t) = 1/t\)</span>.</p>
</section>
<section id="span-style-color-4cc9f0-pesos-sinapticos-span">
<h3><span style="color:#4CC9F0">Pesos sinápticos</span><a class="headerlink" href="#span-style-color-4cc9f0-pesos-sinapticos-span" title="Enlazar permanentemente con este título">#</a></h3>
<p>Fuente: <a class="reference external" href="https://arxiv.org/pdf/1312.5753.pdf">Matias Carrasco Kind y Robert J. Brunner</a></p>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Machine_Learning/Imagenes/som_structure.png" width="300" height="200" align="left"/>
</center>
</figure>
<p>De acuerdo con lo dicho antes, todas las neuronas en la grilla de las neuronas del SOM, se conectan con todas las neuronas a la entrada de los estímulos(datos de entrada). Entonces, si el SOM tiene total <span class="math notranslate nohighlight">\(d\)</span> neuronas y los vectores de entrada tiene dimensión <span class="math notranslate nohighlight">\(n\)</span>, lo que implica que hay <span class="math notranslate nohighlight">\(n\)</span> neuronas en la capa de entrada, entonces la fuerza de las conexiones se conocen como peso sináptico y son en total <span class="math notranslate nohighlight">\(n\times d\)</span> pesos. La matriz <span class="math notranslate nohighlight">\(W_{n\times d}\)</span> se usa para representar todos los pesos sinápticos.</p>
<p>El objetivo del proceso de entrenamiento es <code class="docutils literal notranslate"><span class="pre">aprender</span></code> o estimar  estos pesos.</p>
</section>
<section id="span-style-color-4cc9f0-asignacion-de-los-datos-a-las-neuronas-en-el-som-span">
<h3><span style="color:#4CC9F0">Asignación de los datos a las neuronas en el SOM</span><a class="headerlink" href="#span-style-color-4cc9f0-asignacion-de-los-datos-a-las-neuronas-en-el-som-span" title="Enlazar permanentemente con este título">#</a></h3>
<p>Una vez la red está entrenada, la asignación se hace de la siguiente forma. La fila <span class="math notranslate nohighlight">\(i\)</span> de la matriz <span class="math notranslate nohighlight">\(W\)</span> representa el vector de pesos sinapticos asociado la naurona <span class="math notranslate nohighlight">\(i\)</span>. Estos vectores estan en el mismo espacio del conjunto de entrenamiento. Se calcula la distancia geométrica entre el patron <span class="math notranslate nohighlight">\(x\)</span> que está entrando a la red y cada fila de  <span class="math notranslate nohighlight">\(W\)</span>. La neurona seleccionada es aquella que está a menor distancia. En otras palabras, la neurona <span class="math notranslate nohighlight">\(i\)</span> se selecciona si</p>
<div class="math notranslate nohighlight">
\[
||x-w_i|| = min_{j} ||x-w_j||, j=1,\ldots,N.
\]</div>
<p>Tambien se puede escribir</p>
<div class="math notranslate nohighlight">
\[
i = \arg \min_{j}||x-w_j||.
\]</div>
</section>
</section>
<section id="span-style-color-4361ee-el-algortimo-de-entrenamiento-som-span">
<h2><span style="color:#4361EE">El algortimo de entrenamiento SOM</span><a class="headerlink" href="#span-style-color-4361ee-el-algortimo-de-entrenamiento-som-span" title="Enlazar permanentemente con este título">#</a></h2>
<p>En esta sección se describe el algortimo base desarrollado por Kohonen.</p>
<p>Consideramos un SOM con cuadrícula rectangular bidimensional de <span class="math notranslate nohighlight">\( N \)</span> neuronas. También se pueden usar otras opciones, como cuadrículas hexagonales.</p>
<p>Cada uno de las <span class="math notranslate nohighlight">\(N\)</span> neuronas  está parametrizada por un par de coordenadas enteras <span class="math notranslate nohighlight">\((i_1,i_2)\)</span>, que corresponde a su posición en la grilla que define el mapa.</p>
<p>Usaremos como función de vecindad, el kernel Gaussiano <span class="math notranslate nohighlight">\(h_{ij}(t)\)</span> definido arriba. Existen muchas posibilidades para definir la función de vecindad.</p>
<p>Sea <span class="math notranslate nohighlight">\(\sigma^2\)</span> un valor inicial para el parámetro de dipersión de la función de vecindad y definimos <span class="math notranslate nohighlight">\(\alpha(t) = 1/t\)</span> como la rata de aprendizaje. Definimos <span class="math notranslate nohighlight">\(\sigma^2(t)= \alpha(t)\sigma^2\)</span>.</p>
<p>Hay muchas formas de definir <span class="math notranslate nohighlight">\(\alpha(t)\)</span>, que cumplen las condiciones de Robbins-Monro. Ocurre lo mismo con <span class="math notranslate nohighlight">\(\sigma^2(t)\)</span>.</p>
<p>El algoritmo de entrenamiento es como sigue.</p>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Machine_Learning/Imagenes/som_learning_rule.jpg" width="300" height="200" align="right"/>
</center>
</figure>
<ol class="simple">
<li><p>Inicializar los pesos sinápticos de las neuronas de manera aleatoria. Es decir la matriz <span class="math notranslate nohighlight">\(W\)</span> se inicializa aleatoriamente.</p></li>
<li><p>Obtenga una muestra aleatoria <span class="math notranslate nohighlight">\(x\)</span> del conjunto de entrenamiento <span class="math notranslate nohighlight">\(X\)</span> y seleccione para este patrón  la mejor neurona <span class="math notranslate nohighlight">\(i\)</span> como</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
i = \arg \min_{j}||x-w_j||
\]</div>
<ol class="simple">
<li><p>En el tiempo <span class="math notranslate nohighlight">\(t+1\)</span> actualice todos los pesos sinápticos</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
w_j^{(t+1)} = w_j^{(t)} - \alpha(t)\times h_{ij}(t)\times (w_j-x)
\]</div>
<ol class="simple">
<li><p>Repita los pasos 2 y 3 hasta completar un número de épocas o cumplir un criterio de convergencia.</p></li>
</ol>
<p>Fuente: <a class="reference external" href="https://www.researchgate.net/publication/340257021_Neurons_as_Pattern_Recognizers_CDT-25/figures?lo=1">Luciano da F. Costa, Research gate</a></p>
<div class="note admonition">
<p class="admonition-title">Nota</p>
<p>El algoritmo es una generalización del gradiente descendiente estocástico. La presencia de la función de vecindad tiene el efecto de disminuir el efecto del gradiente de acuerdo con la función de vecindad. Las neuronas vecinas más cercanas a la ganadora reciben una valor relativo más grande de actualización. Es decir, neuronas lejanas a la ganadora reciben la señal de actualización cada vez mas atenuada.</p>
</div>
</section>
<section id="span-style-color-4361ee-ejemplos-con-minisom-span">
<h2><span style="color:#4361EE">Ejemplos con Minisom</span><a class="headerlink" href="#span-style-color-4361ee-ejemplos-con-minisom-span" title="Enlazar permanentemente con este título">#</a></h2>
<section id="span-style-color-4cc9f0-datos-simulados-span">
<h3><span style="color:#4CC9F0">Datos simulados</span><a class="headerlink" href="#span-style-color-4cc9f0-datos-simulados-span" title="Enlazar permanentemente con este título">#</a></h3>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Machine_Learning/Imagenes/simulation_to_SOM.png" width="400" height="300" align="center"/>
</center>
<figcaption>
<p style="text-align:center"> Ejemplo de datos simulados</p>
</figcaption>
</figure>
<p>Fuente: Hastie et al. <a class="reference external" href="https://web.stanford.edu/~hastie/Papers/ESLII.pdf">The elements of the Statistical Learning</a>, Standford, 2008.</p>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Machine_Learning/Imagenes/SOM_to_Simulate_data.png" width="600" height="200" align="center"/>
</center>
<figcaption>
<p style="text-align:center"> Mapas autoorganizado de los datos simulados. A  la izquierda la configuración inicial. A la derecha la configuración final.</p>
</figcaption>
</figure>
<p>Fuente: Hastie et al. <a class="reference external" href="https://web.stanford.edu/~hastie/Papers/ESLII.pdf">The elements of the Statistical Learning</a>, Standford, 2008.</p>
</section>
<section id="span-style-color-4cc9f0-un-primer-ejemplo-historico-grafico-de-la-pobreza-span">
<h3><span style="color:#4CC9F0">Un primer ejemplo histórico. Gráfico de la pobreza</span><a class="headerlink" href="#span-style-color-4cc9f0-un-primer-ejemplo-historico-grafico-de-la-pobreza-span" title="Enlazar permanentemente con este título">#</a></h3>
<figure>
<center>
<img src="https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Machine_Learning/Imagenes/poverty.png" width="600" height="500" align="center"/>
</center>
<figcaption>
<p style="text-align:center"> Ejemplo histórico. Mapa de la probreza</p>
</figcaption>
</figure>
<p>Fuente: Kohonen. <a class="reference external" href="http://www.cis.hut.fi/research/som-research/worldmap.html">Poverty map</a>, 1997.</p>
</section>
<section id="span-style-color-4cc9f0-codigos-con-minisom-span">
<h3><span style="color:#4CC9F0">Códigos con Minisom</span><a class="headerlink" href="#span-style-color-4cc9f0-codigos-con-minisom-span" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">minisom</span> <span class="kn">import</span> <span class="n">MiniSom</span> 
</pre></div>
</div>
</div>
</div>
<p>Ahora generamos y visualizamos algunos conjuntos de datos con Minisom.</p>
<p>MiniSom implementa dos tipos de entrenamiento.</p>
<ol class="simple">
<li><p>El entrenamiento secuencial, implementado por el método <em>train_random</em>, donde el modelo se entrena seleccionando muestras aleatorias de sus datos.</p></li>
<li><p>El entrenamiento por lotes, implementado por el método <em>train_batch</em>, donde las muestras se seleccionan en el orden en que se almacenan.</p></li>
</ol>
<p>Los pesos de la red se inicializan aleatoriamente de forma predeterminada.</p>
<p>Se proporcionan dos métodos adicionales para inicializar los pesos de una manera basada en datos: <em>random_weights_init</em> y <em>pca_weights_init</em>.</p>
<p>Para obtener una descripción general de todas las funciones implementadas en minisom, puede examinar los siguientes ejemplos en Github:
<a class="reference external" href="https://github.com/JustGlowing/minisom/tree/master/examples">https://github.com/JustGlowing/minisom/tree/master/examples</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;../&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">minisom</span> <span class="kn">import</span> <span class="n">MiniSom</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="o">%</span><span class="k">load_ext</span> autoreload
</pre></div>
</div>
</div>
</div>
<p>En lo que sigue, el error de cuantización (quatization error)es el error de reconstrucción y es dado por</p>
<p>$<span class="math notranslate nohighlight">\(
q_err = \frac{1}{N} \sum ||x-w_j||^2
\)</span>$,</p>
<p>en donde la suma es sobre los <span class="math notranslate nohighlight">\(x\)</span>’s y en donde <span class="math notranslate nohighlight">\(w_j\)</span> es el correspondiente prototipo de <span class="math notranslate nohighlight">\(x\)</span>.</p>
</section>
<section id="span-style-color-4cc9f0-digitos-a-mano-alzada-span">
<h3><span style="color:#4CC9F0">Dígitos a mano alzada</span><a class="headerlink" href="#span-style-color-4cc9f0-digitos-a-mano-alzada-span" title="Enlazar permanentemente con este título">#</a></h3>
<p>Eso son son los datos de MNIST. Probablemente es un subconjunto.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;../&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">minisom</span> <span class="kn">import</span> <span class="n">MiniSom</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="o">%</span><span class="k">load_ext</span> autoreload
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">autoreload</span> 2
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">scale</span>

<span class="c1"># load the digits dataset from scikit-learn</span>
<span class="n">digits</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_digits</span><span class="p">(</span><span class="n">n_class</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># matrix where each row is a vector that represent a digit.</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">scale</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">num</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">target</span>  <span class="c1"># num[i] is the digit represented by data[i]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">digits</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1797, 64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">autoreload</span> 2
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">scale</span>

<span class="c1"># load the digits dataset from scikit-learn</span>
<span class="n">digits</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_digits</span><span class="p">(</span><span class="n">n_class</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># matrix where each row is a vector that represent a digit.</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">scale</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">num</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">target</span>  <span class="c1"># num[i] is the digit represented by data[i]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">som</span> <span class="o">=</span> <span class="n">MiniSom</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
              <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">neighborhood_function</span><span class="o">=</span><span class="s1">&#39;triangle&#39;</span><span class="p">)</span>
<span class="n">som</span><span class="o">.</span><span class="n">pca_weights_init</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training...&quot;</span><span class="p">)</span>
<span class="n">som</span><span class="o">.</span><span class="n">train_random</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># random training</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">...ready!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>...ready!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">wmap</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">im</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>  <span class="c1"># scatterplot</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">som</span><span class="o">.</span><span class="n">winner</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">wmap</span><span class="p">[</span><span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">im</span>
    <span class="n">plt</span><span class="o">.</span> <span class="n">text</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">.5</span><span class="p">,</span>  <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">.5</span><span class="p">,</span>  <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
              <span class="n">color</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span><span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="mf">10.</span><span class="p">),</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>  <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">im</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">som</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span>  <span class="n">som</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="c1">#Guardar localmente </span>
<span class="c1">#plt.savefig(&#39;../Imagenes/som_digts.png&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/som_Introduccion_62_0.png" src="../../_images/som_Introduccion_62_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)):</span>  <span class="c1"># images mosaic</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">cnt</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="n">xticks</span><span class="o">=</span><span class="p">[],</span>  <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">wmap</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">digits</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">wmap</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)]],</span>
                       <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)),</span>  <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c1">#Guardar localmente</span>
<span class="c1">#plt.savefig(&#39;../Imagenes/som_digts_imgs.png&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="span-style-color-4cc9f0-indice-de-democracia-span">
<h3><span style="color:#4CC9F0">índice de democracia</span><a class="headerlink" href="#span-style-color-4cc9f0-indice-de-democracia-span" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;../&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Patch</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">minisom</span> <span class="kn">import</span> <span class="n">MiniSom</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">minmax_scale</span><span class="p">,</span> <span class="n">scale</span>
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download from wikipedia and reorganization</span>
 <span class="c1"># pre-downloaded file</span>
<span class="n">democracy_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/AprendizajeProfundo/Libro-Fundamentos/main/Machine_Learning/Datos/democracy_index.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">democracy_index</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>rank</th>
      <th>country</th>
      <th>democracy_index</th>
      <th>electoral_processand_pluralism</th>
      <th>functioning_of_government</th>
      <th>political_participation</th>
      <th>political_culture</th>
      <th>civil_liberties</th>
      <th>category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>Norway</td>
      <td>9.87</td>
      <td>10.00</td>
      <td>9.64</td>
      <td>10.00</td>
      <td>10.00</td>
      <td>9.71</td>
      <td>Full democracy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>Iceland</td>
      <td>9.58</td>
      <td>10.00</td>
      <td>9.29</td>
      <td>8.89</td>
      <td>10.00</td>
      <td>9.71</td>
      <td>Full democracy</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>Sweden</td>
      <td>9.39</td>
      <td>9.58</td>
      <td>9.64</td>
      <td>8.33</td>
      <td>10.00</td>
      <td>9.41</td>
      <td>Full democracy</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>New Zealand</td>
      <td>9.26</td>
      <td>10.00</td>
      <td>9.29</td>
      <td>8.89</td>
      <td>8.13</td>
      <td>10.00</td>
      <td>Full democracy</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>Denmark</td>
      <td>9.22</td>
      <td>10.00</td>
      <td>9.29</td>
      <td>8.33</td>
      <td>9.38</td>
      <td>9.12</td>
      <td>Full democracy</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">category_color</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Full democracy&#39;</span><span class="p">:</span> <span class="s1">&#39;darkgreen&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Flawed democracy&#39;</span><span class="p">:</span> <span class="s1">&#39;limegreen&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Hybrid regime&#39;</span><span class="p">:</span> <span class="s1">&#39;darkorange&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Authoritarian&#39;</span><span class="p">:</span> <span class="s1">&#39;crimson&#39;</span><span class="p">}</span>
<span class="n">colors_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="p">:</span> <span class="n">category_color</span><span class="p">[</span><span class="n">dm</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">dm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">democracy_index</span><span class="o">.</span><span class="n">country</span><span class="p">,</span>
                                                      <span class="n">democracy_index</span><span class="o">.</span><span class="n">category</span><span class="p">)}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">country_codes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Afghanistan&#39;</span><span class="p">:</span> <span class="s1">&#39;AF&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Albania&#39;</span><span class="p">:</span> <span class="s1">&#39;AL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Algeria&#39;</span><span class="p">:</span> <span class="s1">&#39;DZ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Angola&#39;</span><span class="p">:</span> <span class="s1">&#39;AO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Argentina&#39;</span><span class="p">:</span> <span class="s1">&#39;AR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Armenia&#39;</span><span class="p">:</span> <span class="s1">&#39;AM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Australia&#39;</span><span class="p">:</span> <span class="s1">&#39;AU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Austria&#39;</span><span class="p">:</span> <span class="s1">&#39;AT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Azerbaijan&#39;</span><span class="p">:</span> <span class="s1">&#39;AZ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bahrain&#39;</span><span class="p">:</span> <span class="s1">&#39;BH&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bangladesh&#39;</span><span class="p">:</span> <span class="s1">&#39;BD&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Belarus&#39;</span><span class="p">:</span> <span class="s1">&#39;BY&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Belgium&#39;</span><span class="p">:</span> <span class="s1">&#39;BE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Benin&#39;</span><span class="p">:</span> <span class="s1">&#39;BJ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bhutan&#39;</span><span class="p">:</span> <span class="s1">&#39;BT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bolivia&#39;</span><span class="p">:</span> <span class="s1">&#39;BO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bosnia and Herzegovina&#39;</span><span class="p">:</span> <span class="s1">&#39;BA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Botswana&#39;</span><span class="p">:</span> <span class="s1">&#39;BW&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Brazil&#39;</span><span class="p">:</span> <span class="s1">&#39;BR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bulgaria&#39;</span><span class="p">:</span> <span class="s1">&#39;BG&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Burkina Faso&#39;</span><span class="p">:</span> <span class="s1">&#39;BF&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Burundi&#39;</span><span class="p">:</span> <span class="s1">&#39;BI&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cambodia&#39;</span><span class="p">:</span> <span class="s1">&#39;KH&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cameroon&#39;</span><span class="p">:</span> <span class="s1">&#39;CM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Canada&#39;</span><span class="p">:</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cape Verde&#39;</span><span class="p">:</span> <span class="s1">&#39;CV&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Central African Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;CF&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chad&#39;</span><span class="p">:</span> <span class="s1">&#39;TD&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chile&#39;</span><span class="p">:</span> <span class="s1">&#39;CL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;China&#39;</span><span class="p">:</span> <span class="s1">&#39;CN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Colombia&#39;</span><span class="p">:</span> <span class="s1">&#39;CO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Comoros&#39;</span><span class="p">:</span> <span class="s1">&#39;KM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Costa Rica&#39;</span><span class="p">:</span> <span class="s1">&#39;CR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Croatia&#39;</span><span class="p">:</span> <span class="s1">&#39;HR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cuba&#39;</span><span class="p">:</span> <span class="s1">&#39;CU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cyprus&#39;</span><span class="p">:</span> <span class="s1">&#39;CY&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Czech Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;CZ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Democratic Republic of the Congo&#39;</span><span class="p">:</span> <span class="s1">&#39;CD&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Denmark&#39;</span><span class="p">:</span> <span class="s1">&#39;DK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Djibouti&#39;</span><span class="p">:</span> <span class="s1">&#39;DJ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dominican Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;DO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ecuador&#39;</span><span class="p">:</span> <span class="s1">&#39;EC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Egypt&#39;</span><span class="p">:</span> <span class="s1">&#39;EG&#39;</span><span class="p">,</span>
 <span class="s1">&#39;El Salvador&#39;</span><span class="p">:</span> <span class="s1">&#39;SV&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Equatorial Guinea&#39;</span><span class="p">:</span> <span class="s1">&#39;GQ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Eritrea&#39;</span><span class="p">:</span> <span class="s1">&#39;ER&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Estonia&#39;</span><span class="p">:</span> <span class="s1">&#39;EE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ethiopia&#39;</span><span class="p">:</span> <span class="s1">&#39;ET&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fiji&#39;</span><span class="p">:</span> <span class="s1">&#39;FJ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Finland&#39;</span><span class="p">:</span> <span class="s1">&#39;FI&#39;</span><span class="p">,</span>
 <span class="s1">&#39;France&#39;</span><span class="p">:</span> <span class="s1">&#39;FR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gabon&#39;</span><span class="p">:</span> <span class="s1">&#39;GA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gambia&#39;</span><span class="p">:</span> <span class="s1">&#39;GM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Georgia&#39;</span><span class="p">:</span> <span class="s1">&#39;GE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Germany&#39;</span><span class="p">:</span> <span class="s1">&#39;DE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ghana&#39;</span><span class="p">:</span> <span class="s1">&#39;GH&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Greece&#39;</span><span class="p">:</span> <span class="s1">&#39;GR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Guatemala&#39;</span><span class="p">:</span> <span class="s1">&#39;GT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Guinea&#39;</span><span class="p">:</span> <span class="s1">&#39;GN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Guinea-Bissau&#39;</span><span class="p">:</span> <span class="s1">&#39;GW&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Guyana&#39;</span><span class="p">:</span> <span class="s1">&#39;GY&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Haiti&#39;</span><span class="p">:</span> <span class="s1">&#39;HT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Honduras&#39;</span><span class="p">:</span> <span class="s1">&#39;HN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hong Kong&#39;</span><span class="p">:</span> <span class="s1">&#39;HK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hungary&#39;</span><span class="p">:</span> <span class="s1">&#39;HU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Iceland&#39;</span><span class="p">:</span> <span class="s1">&#39;IS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;India&#39;</span><span class="p">:</span> <span class="s1">&#39;IN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Indonesia&#39;</span><span class="p">:</span> <span class="s1">&#39;ID&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Iran&#39;</span><span class="p">:</span> <span class="s1">&#39;IR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Iraq&#39;</span><span class="p">:</span> <span class="s1">&#39;IQ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ireland&#39;</span><span class="p">:</span> <span class="s1">&#39;IE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Israel&#39;</span><span class="p">:</span> <span class="s1">&#39;IL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Italy&#39;</span><span class="p">:</span> <span class="s1">&#39;IT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ivory Coast&#39;</span><span class="p">:</span> <span class="s1">&#39;IC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Jamaica&#39;</span><span class="p">:</span> <span class="s1">&#39;JM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Japan&#39;</span><span class="p">:</span> <span class="s1">&#39;JP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Jordan&#39;</span><span class="p">:</span> <span class="s1">&#39;JO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kazakhstan&#39;</span><span class="p">:</span> <span class="s1">&#39;KZ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kenya&#39;</span><span class="p">:</span> <span class="s1">&#39;KE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kuwait&#39;</span><span class="p">:</span> <span class="s1">&#39;KW&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kyrgyzstan&#39;</span><span class="p">:</span> <span class="s1">&#39;KG&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Laos&#39;</span><span class="p">:</span> <span class="s1">&#39;LA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Latvia&#39;</span><span class="p">:</span> <span class="s1">&#39;LV&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lebanon&#39;</span><span class="p">:</span> <span class="s1">&#39;LB&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lesotho&#39;</span><span class="p">:</span> <span class="s1">&#39;LS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Liberia&#39;</span><span class="p">:</span> <span class="s1">&#39;LR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Libya&#39;</span><span class="p">:</span> <span class="s1">&#39;LY&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lithuania&#39;</span><span class="p">:</span> <span class="s1">&#39;LT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Luxembourg&#39;</span><span class="p">:</span> <span class="s1">&#39;LU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Macedonia&#39;</span><span class="p">:</span> <span class="s1">&#39;MK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Madagascar&#39;</span><span class="p">:</span> <span class="s1">&#39;MG&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Malawi&#39;</span><span class="p">:</span> <span class="s1">&#39;MW&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Malaysia&#39;</span><span class="p">:</span> <span class="s1">&#39;MY&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mali&#39;</span><span class="p">:</span> <span class="s1">&#39;ML&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Malta&#39;</span><span class="p">:</span> <span class="s1">&#39;MT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mauritania&#39;</span><span class="p">:</span> <span class="s1">&#39;MR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mauritius&#39;</span><span class="p">:</span> <span class="s1">&#39;MU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mexico&#39;</span><span class="p">:</span> <span class="s1">&#39;MX&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Moldova&#39;</span><span class="p">:</span> <span class="s1">&#39;MD&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mongolia&#39;</span><span class="p">:</span> <span class="s1">&#39;MN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Montenegro&#39;</span><span class="p">:</span> <span class="s1">&#39;ME&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Morocco&#39;</span><span class="p">:</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mozambique&#39;</span><span class="p">:</span> <span class="s1">&#39;MZ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Myanmar&#39;</span><span class="p">:</span> <span class="s1">&#39;MM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Namibia&#39;</span><span class="p">:</span> <span class="s1">&#39;NA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Nepal&#39;</span><span class="p">:</span> <span class="s1">&#39;NP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Netherlands&#39;</span><span class="p">:</span> <span class="s1">&#39;NL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;New Zealand&#39;</span><span class="p">:</span> <span class="s1">&#39;NZ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;North Macedonia&#39;</span><span class="p">:</span> <span class="s1">&#39;NM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Nicaragua&#39;</span><span class="p">:</span> <span class="s1">&#39;NI&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Niger&#39;</span><span class="p">:</span> <span class="s1">&#39;NE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Nigeria&#39;</span><span class="p">:</span> <span class="s1">&#39;NG&#39;</span><span class="p">,</span>
 <span class="s1">&#39;North Korea&#39;</span><span class="p">:</span> <span class="s1">&#39;KP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Norway&#39;</span><span class="p">:</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Oman&#39;</span><span class="p">:</span> <span class="s1">&#39;OM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pakistan&#39;</span><span class="p">:</span> <span class="s1">&#39;PK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Palestine&#39;</span><span class="p">:</span> <span class="s1">&#39;PS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Panama&#39;</span><span class="p">:</span> <span class="s1">&#39;PA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Papua New Guinea&#39;</span><span class="p">:</span> <span class="s1">&#39;PG&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Paraguay&#39;</span><span class="p">:</span> <span class="s1">&#39;PY&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Peru&#39;</span><span class="p">:</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Philippines&#39;</span><span class="p">:</span> <span class="s1">&#39;PH&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Poland&#39;</span><span class="p">:</span> <span class="s1">&#39;PL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Portugal&#39;</span><span class="p">:</span> <span class="s1">&#39;PT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Qatar&#39;</span><span class="p">:</span> <span class="s1">&#39;QA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Republic of China (Taiwan)&#39;</span><span class="p">:</span> <span class="s1">&#39;TW&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Republic of the Congo&#39;</span><span class="p">:</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Romania&#39;</span><span class="p">:</span> <span class="s1">&#39;RO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Russia&#39;</span><span class="p">:</span> <span class="s1">&#39;RU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Rwanda&#39;</span><span class="p">:</span> <span class="s1">&#39;RW&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Saudi Arabia&#39;</span><span class="p">:</span> <span class="s1">&#39;SA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Senegal&#39;</span><span class="p">:</span> <span class="s1">&#39;SN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Serbia&#39;</span><span class="p">:</span> <span class="s1">&#39;RS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sierra Leone&#39;</span><span class="p">:</span> <span class="s1">&#39;SL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Singapore&#39;</span><span class="p">:</span> <span class="s1">&#39;SG&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Slovakia&#39;</span><span class="p">:</span> <span class="s1">&#39;SK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Slovenia&#39;</span><span class="p">:</span> <span class="s1">&#39;SI&#39;</span><span class="p">,</span>
 <span class="s1">&#39;South Africa&#39;</span><span class="p">:</span> <span class="s1">&#39;ZA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;South Korea&#39;</span><span class="p">:</span> <span class="s1">&#39;KR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Spain&#39;</span><span class="p">:</span> <span class="s1">&#39;ES&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sri Lanka&#39;</span><span class="p">:</span> <span class="s1">&#39;LK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sudan&#39;</span><span class="p">:</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Suriname&#39;</span><span class="p">:</span> <span class="s1">&#39;SR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Swaziland&#39;</span><span class="p">:</span> <span class="s1">&#39;SZ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sweden&#39;</span><span class="p">:</span> <span class="s1">&#39;SE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Switzerland&#39;</span><span class="p">:</span> <span class="s1">&#39;CH&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Syria&#39;</span><span class="p">:</span> <span class="s1">&#39;SY&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Tajikistan&#39;</span><span class="p">:</span> <span class="s1">&#39;TJ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Tanzania&#39;</span><span class="p">:</span> <span class="s1">&#39;TZ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Thailand&#39;</span><span class="p">:</span> <span class="s1">&#39;TH&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Timor-Leste&#39;</span><span class="p">:</span> <span class="s1">&#39;TL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Togo&#39;</span><span class="p">:</span> <span class="s1">&#39;TG&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Trinidad and Tobago&#39;</span><span class="p">:</span> <span class="s1">&#39;TT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Tunisia&#39;</span><span class="p">:</span> <span class="s1">&#39;TN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Turkey&#39;</span><span class="p">:</span> <span class="s1">&#39;TR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Turkmenistan&#39;</span><span class="p">:</span> <span class="s1">&#39;TM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Uganda&#39;</span><span class="p">:</span> <span class="s1">&#39;UG&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ukraine&#39;</span><span class="p">:</span> <span class="s1">&#39;UA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;United Arab Emirates&#39;</span><span class="p">:</span> <span class="s1">&#39;AE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;United Kingdom&#39;</span><span class="p">:</span> <span class="s1">&#39;GB&#39;</span><span class="p">,</span>
 <span class="s1">&#39;United States&#39;</span><span class="p">:</span> <span class="s1">&#39;US&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Uruguay&#39;</span><span class="p">:</span> <span class="s1">&#39;UY&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Uzbekistan&#39;</span><span class="p">:</span> <span class="s1">&#39;UZ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Venezuela&#39;</span><span class="p">:</span> <span class="s1">&#39;VE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Vietnam&#39;</span><span class="p">:</span> <span class="s1">&#39;VN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Yemen&#39;</span><span class="p">:</span> <span class="s1">&#39;YE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Zambia&#39;</span><span class="p">:</span> <span class="s1">&#39;ZM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Zimbabwe&#39;</span><span class="p">:</span> <span class="s1">&#39;ZW&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;democracy_index&#39;</span><span class="p">,</span> <span class="s1">&#39;electoral_processand_pluralism&#39;</span><span class="p">,</span> <span class="s1">&#39;functioning_of_government&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;political_participation&#39;</span><span class="p">,</span> <span class="s1">&#39;political_culture&#39;</span><span class="p">,</span> <span class="s1">&#39;civil_liberties&#39;</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">democracy_index</span><span class="p">[</span><span class="n">feature_names</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scale</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">size</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">som</span> <span class="o">=</span> <span class="n">MiniSom</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
              <span class="n">neighborhood_function</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
              <span class="n">random_seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">som</span><span class="o">.</span><span class="n">pca_weights_init</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">som</span><span class="o">.</span><span class="n">train_random</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="map-of-countries">
<h2>Map of countries<a class="headerlink" href="#map-of-countries" title="Enlazar permanentemente con este título">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">shorten_country</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">country_codes</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">c</span>

<span class="n">country_map</span> <span class="o">=</span> <span class="n">som</span><span class="o">.</span><span class="n">labels_map</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">democracy_index</span><span class="o">.</span><span class="n">country</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
<span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">countries</span> <span class="ow">in</span> <span class="n">country_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">countries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">countries</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">.1</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">.3</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">countries</span><span class="p">):</span>
        <span class="n">off_set</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">countries</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.05</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">off_set</span><span class="p">,</span> <span class="n">shorten_country</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">colors_dict</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">som</span><span class="o">.</span><span class="n">distance_map</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray_r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">legend_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Patch</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span>
                         <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>
                         <span class="n">label</span><span class="o">=</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">clr</span> <span class="ow">in</span> <span class="n">category_color</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_elements</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.95</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/som_Introduccion_72_0.png" src="../../_images/som_Introduccion_72_0.png" />
</div>
</div>
<section id="span-style-color-4cc9f0-planos-de-catacteristicas-span">
<h3><span style="color:#4CC9F0">Planos de Catacterísticas</span><a class="headerlink" href="#span-style-color-4cc9f0-planos-de-catacteristicas-span" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="n">som</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">feature_names</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">W</span><span class="p">[:,:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/som_Introduccion_74_0.png" src="../../_images/som_Introduccion_74_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(15, 15, 6)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[ 8.64374915e-01, -4.50169698e-01, -3.02682978e-01,
         -6.02310996e-01, -4.46642778e-01,  6.29517283e-01],
        [ 8.05202458e-01, -3.92854281e-01, -2.66694796e-01,
         -6.43057497e-01, -3.86914389e-01,  5.44843816e-01],
        [ 7.44278989e-01, -3.31133203e-01, -2.27724788e-01,
         -6.81521083e-01, -3.23807909e-01,  4.59388921e-01],
        ...,
        [-1.46890342e+00, -1.59535361e+00, -1.20381277e+00,
         -1.75580761e+00,  1.02555483e-01, -1.62261127e+00],
        [-1.65153811e+00, -1.64408844e+00, -1.72309901e+00,
         -1.28627034e+00, -4.30388961e-01, -1.81893501e+00],
        [-1.74717853e+00, -1.54529548e+00, -1.76787926e+00,
         -1.58593808e+00, -1.24030803e+00, -1.59126763e+00]],

       [[ 7.99954026e-01, -4.42892025e-01, -2.95266549e-01,
         -4.75381820e-01, -4.42364076e-01,  6.24196459e-01],
        [ 7.40503442e-01, -3.84454044e-01, -2.58770289e-01,
         -5.15635016e-01, -3.82013522e-01,  5.39468858e-01],
        [ 6.76477338e-01, -3.06960506e-01, -2.11724747e-01,
         -5.47200622e-01, -3.09385079e-01,  4.53850602e-01],
        ...,
        [-1.44018686e+00, -1.60716669e+00, -1.20141418e+00,
         -1.36950419e+00, -2.57206291e-01, -1.54145528e+00],
        [-1.69195607e+00, -1.57934470e+00, -1.53438291e+00,
         -1.48575211e+00, -1.03287481e+00, -1.73828499e+00],
        [-1.86122570e+00, -1.54473433e+00, -1.34401107e+00,
         -1.79916742e+00, -2.04028002e+00, -1.81717708e+00]],

       [[ 7.35322833e-01, -4.35158538e-01, -2.87720534e-01,
         -3.48201204e-01, -4.37989925e-01,  6.18919074e-01],
        [ 6.72722642e-01, -3.67369522e-01, -2.48608290e-01,
         -3.83102145e-01, -3.75479702e-01,  5.35789416e-01],
        [ 6.02867920e-01, -2.28355757e-01, -1.84344337e-01,
         -3.84033636e-01, -2.82851558e-01,  4.64107047e-01],
        ...,
        [-1.29907400e+00, -1.61580450e+00, -1.33009055e+00,
         -7.15700407e-01, -2.56591337e-01, -1.28486718e+00],
        [-1.40556481e+00, -1.54124964e+00, -1.25623968e+00,
         -9.34592999e-01, -9.31201990e-01, -1.32237951e+00],
        [-1.61310457e+00, -1.54528881e+00, -1.10076567e+00,
         -1.49349113e+00, -1.60718421e+00, -1.50627048e+00]],

       ...,

       [[-2.10309783e-01,  7.42831290e-02, -4.18929818e-01,
          2.72239818e-01, -1.34861411e+00,  7.13932158e-02],
        [-1.95747148e-01,  1.41121606e-01, -6.41590159e-01,
          3.41074688e-01, -1.09638072e+00,  5.58684217e-02],
        [-1.29155995e-01,  7.39983256e-02, -5.42387688e-01,
          5.92562650e-01, -8.31018729e-01,  1.43577640e-02],
        ...,
        [-3.79730464e-01,  2.91691490e-01,  2.17007556e-01,
          4.39058980e-01,  2.27946177e-01, -3.34141701e-01],
        [-6.35937915e-01,  3.71465896e-01,  2.51871868e-01,
          3.88900257e-01,  3.61463754e-01, -5.15397092e-01],
        [-7.29862938e-01,  4.33666026e-01,  2.86797306e-01,
          3.46392114e-01,  4.35014939e-01, -6.17021945e-01]],

       [[-1.36536072e-01,  1.02609880e-03, -4.77226460e-01,
          6.09394816e-01, -9.23636264e-01,  8.79548994e-02],
        [-1.92625524e-01,  9.38826564e-02, -7.39894288e-01,
          7.10439201e-01, -7.96745461e-01, -1.99956017e-01],
        [-3.26542073e-01, -1.97859533e-01, -9.54418193e-01,
          8.82588116e-01, -6.19115352e-01, -3.74700407e-01],
        ...,
        [-5.88549713e-01,  3.14495906e-01,  2.16400082e-01,
          5.46118593e-01,  2.88678302e-01, -4.13000332e-01],
        [-7.30661544e-01,  3.83722329e-01,  2.58439096e-01,
          5.15659227e-01,  3.78694054e-01, -5.34437054e-01],
        [-7.99473045e-01,  4.42813270e-01,  2.95235964e-01,
          4.75373824e-01,  4.42171614e-01, -6.23948977e-01]],

       [[-1.11178445e-01, -2.28572486e-01, -3.66484195e-01,
          9.92553665e-01, -6.17339337e-01,  2.56656858e-01],
        [-2.89645176e-01, -2.48068563e-01, -7.65550425e-01,
          1.03508315e+00, -6.48700844e-01, -2.78123395e-01],
        [-4.87879119e-01, -4.32828184e-01, -1.25858060e+00,
          1.06259458e+00, -5.43419506e-01, -6.19705296e-01],
        ...,
        [-7.25402189e-01,  3.32354930e-01,  2.27637824e-01,
          6.78660556e-01,  3.20017640e-01, -4.51947559e-01],
        [-8.03294631e-01,  3.92628210e-01,  2.66429351e-01,
          6.42783587e-01,  3.86294709e-01, -5.43984673e-01],
        [-8.64296348e-01,  4.50152482e-01,  3.02662340e-01,
          6.02302524e-01,  4.46611655e-01, -6.29479168e-01]]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="span-style-color-4cc9f0-plano-de-caracteristicas-mas-importantes-span">
<h3><span style="color:#4CC9F0">Plano de características más importantes</span><a class="headerlink" href="#span-style-color-4cc9f0-plano-de-caracteristicas-mas-importantes-span" title="Enlazar permanentemente con este título">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">som</span><span class="o">.</span><span class="n">_weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">som</span><span class="o">.</span><span class="n">_weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">feature</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="p">,</span> <span class="p">:])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">j</span><span class="o">+</span><span class="mf">.5</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mf">.5</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">feature</span><span class="p">),</span>
                 <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">legend_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Patch</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                         <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>
                         <span class="n">label</span><span class="o">=</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">feature_names</span><span class="p">)]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_elements</span><span class="p">,</span>
           <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span>
           <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.95</span><span class="p">))</span>
        
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\User\AppData\Local\Temp\ipykernel_1672\727562299.py:6: UserWarning: marker is redundantly defined by the &#39;marker&#39; keyword argument and the fmt string &quot;o&quot; (-&gt; marker=&#39;o&#39;). The keyword argument will take precedence.
  plt.plot([j+.5], [i+.5], &#39;o&#39;, color=&#39;C&#39;+str(feature),
</pre></div>
</div>
<img alt="../../_images/som_Introduccion_78_1.png" src="../../_images/som_Introduccion_78_1.png" />
</div>
</div>
</section>
</section>
<section id="span-style-color-4361ee-referencias-span">
<h2><span style="color:#4361EE">Referencias</span><a class="headerlink" href="#span-style-color-4361ee-referencias-span" title="Enlazar permanentemente con este título">#</a></h2>
<ol class="simple">
<li><p>Teuvo Kohonen, <em>Self-Organizing Maps</em>, Third edition, Springer, 2000.</p></li>
<li><p>Erkki Oja and Samuel Kaski editors, <em>Kohonen Maps</em>, Elsevier,</p></li>
<li><p>Christopher Bishop, <em>Pattern Recognition and Machine learning</em>, Springer, 2006.</p></li>
<li><p><a class="reference external" href="https://github.com/JustGlowing/minisom/tree/master/examples">Minisom</a></p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "AprendizajeProfundo/Libro-Fundamentos",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Machine_Learning\Cuadernos"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="ACM.html" title="anterior página">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">anterior</p>
            <p class="prev-next-title"><span style="color:#F72585">Análisis de correspondencias múltiples (ACM)</span></p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../../Redes_Neuronales/Cuadernos/RedesNeuronales_intro.html" title="siguiente página">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">siguiente</p>
        <p class="prev-next-title"><span style="color:#F72585">Introducción a Redes Neuronales</span></p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Álvaro Mauricio Montenegro Díaz, Daniel Mauricio Montenegro Reyes<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>